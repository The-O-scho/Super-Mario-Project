knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,
fig.width = 6, fig.height = 4)
library(tidyverse)
library(knitr)
library(readxl)
library(MASS)
library(dplyr)
library(car)
library(broom)
library(GGally)
#Read in some of the the data for testing
read.csv("World 1-1 Data.csv")
#Read in some of the the data for testing
World_one-one = read.csv("World 1-1 Data.csv")
#Read in some of the the data for testing
World_one_one = read.csv("World 1-1 Data.csv")
World_one_one
mean(World_one_one)
mean(World_one_one[-1])
mean(World_one_one)
glimpse(World_one_one)
World_one_one[-1]
glimpse(World_one_one[-1])
mean(World_one_one[1,])
glimpse(World_one_one[1,])
glimpse(World_one_one[-1,])
mean(World_one_one[-1,])
sum(World_one_one[-1,])
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,
fig.width = 6, fig.height = 4)
library(tidyverse)
library(knitr)
library(readxl)
library(MASS)
library(dplyr)
library(car)
library(broom)
library(GGally)
# Load required libraries
library(faraway)
library(faraway)
# Create a time index since we don't have other predictors
World_one_one$time = 1:nrow(World_one_one)
#Read in some of the the data for testing
World_one_one = read.csv("World 1-1 Data.csv")
sum(World_one_one[-1,]) #Data checks out
# Create a time index since we don't have other predictors
World_one_one$time = 1:nrow(World_one_one)
World_one_one
plot(World_one_one)
#Read in some of the the data for testing
World_one_one = read.csv("World 1-1 Data.csv")
sum(World_one_one[-1,]) #Data checks out
# Create a time index since we don't have other predictors
World_one_one$time = 1:nrow(World_one_one)
# Fit a Poisson GLM with time as predictor
pois_glm = glm(value ~ time, data = World_one_one, family = poisson)
# View summary
summary(pois_glm)
# Test against null model (intercept only)
null_model = glm(value ~ 1, data = World_one_one, family = poisson)
chi_stat = deviance(null_model) - deviance(pois_glm)
df_diff = df.residual(null_model) - df.residual(pois_glm)
p_value = 1 - pchisq(chi_stat, df_diff)
cat("Chi-square test against null model:\n")
cat("Chi-square statistic:", chi_stat, "\n")
cat("df:", df_diff, "\n")
cat("p-value:", p_value, "\n\n")
# Goodness of fit test
gof_p_value = 1 - pchisq(deviance(pois_glm), df.residual(pois_glm))
cat("Goodness of fit test:\n")
cat("Deviance:", deviance(pois_glm), "\n")
cat("df:", df.residual(pois_glm), "\n")
cat("p-value:", gof_p_value, "\n\n")
# Check for overdispersion
dispersion_deviance = deviance(pois_glm) / df.residual(pois_glm)
dispersion_pearson = sum(residuals(pois_glm, type = "pearson")^2) / df.residual(pois_glm)
cat("Dispersion parameter estimates:\n")
cat("Based on deviance:", dispersion_deviance, "\n")
cat("Based on Pearson residuals:", dispersion_pearson, "\n\n")
# Halfnorm plot of residuals
halfnorm(residuals(pois_glm))
install.packages(faraway)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,
fig.width = 6, fig.height = 4)
library(tidyverse)
library(knitr)
library(readxl)
library(MASS)
library(dplyr)
library(car)
library(broom)
library(GGally)
#Read in some of the the data for testing
World_one_one = read.csv("World 1-1 Data.csv")
sum(World_one_one[-1,]) #Data checks out
# Create a time index since we don't have other predictors
World_one_one$time = 1:nrow(World_one_one)
# Fit a Poisson GLM with time as predictor
pois_glm = glm(value ~ time, data = World_one_one, family = poisson)
# View summary
summary(pois_glm)
# Test against null model (intercept only)
null_model = glm(value ~ 1, data = World_one_one, family = poisson)
chi_stat = deviance(null_model) - deviance(pois_glm)
df_diff = df.residual(null_model) - df.residual(pois_glm)
p_value = 1 - pchisq(chi_stat, df_diff)
cat("Chi-square test against null model:\n")
cat("Chi-square statistic:", chi_stat, "\n")
cat("df:", df_diff, "\n")
cat("p-value:", p_value, "\n\n")
# Goodness of fit test
gof_p_value = 1 - pchisq(deviance(pois_glm), df.residual(pois_glm))
cat("Goodness of fit test:\n")
cat("Deviance:", deviance(pois_glm), "\n")
cat("df:", df.residual(pois_glm), "\n")
cat("p-value:", gof_p_value, "\n\n")
# Check for overdispersion
dispersion_deviance = deviance(pois_glm) / df.residual(pois_glm)
dispersion_pearson = sum(residuals(pois_glm, type = "pearson")^2) / df.residual(pois_glm)
cat("Dispersion parameter estimates:\n")
cat("Based on deviance:", dispersion_deviance, "\n")
cat("Based on Pearson residuals:", dispersion_pearson, "\n\n")
# Plot fitted vs observed
plot(log(fitted(pois_glm)), log((World_one_one$value - fitted(pois_glm))^2),
xlab = expression(hat(lambda)),
ylab = expression((y - hat(lambda))^2),
main = "Variance vs Mean Plot")
abline(0, 1)
#Read in some of the the data for testing
World_one_one = read.csv("World 1-1 Data.csv")
sum(World_one_one[-1,]) #Data checks out
# Create a time index since we don't have other predictors
World_one_one$time = 1:nrow(World_one_one)
# Fit a Poisson GLM with time as predictor
pois_glm = glm(value ~ time, data = World_one_one, family = poisson)
# View summary
summary(pois_glm)
# Test against null model (intercept only)
null_model = glm(value ~ 1, data = World_one_one, family = poisson)
chi_stat = deviance(null_model) - deviance(pois_glm)
df_diff = df.residual(null_model) - df.residual(pois_glm)
p_value = 1 - pchisq(chi_stat, df_diff)
cat("Chi-square test against null model:\n")
cat("Chi-square statistic:", chi_stat, "\n")
cat("df:", df_diff, "\n")
cat("p-value:", p_value, "\n\n")
# Goodness of fit test
gof_p_value = 1 - pchisq(deviance(pois_glm), df.residual(pois_glm))
cat("Goodness of fit test:\n")
cat("Deviance:", deviance(pois_glm), "\n")
cat("df:", df.residual(pois_glm), "\n")
cat("p-value:", gof_p_value, "\n\n")
# Check for overdispersion
dispersion_deviance = deviance(pois_glm) / df.residual(pois_glm)
dispersion_pearson = sum(residuals(pois_glm, type = "pearson")^2) / df.residual(pois_glm)
cat("Dispersion parameter estimates:\n")
cat("Based on deviance:", dispersion_deviance, "\n")
cat("Based on Pearson residuals:", dispersion_pearson, "\n\n")
# Plot fitted vs observed
plot(log(fitted(pois_glm)), log((World_one_one$value - fitted(pois_glm))^2),
xlab = expression(hat(lambda)),
ylab = expression((y - hat(lambda))^2),
main = "Variance vs Mean Plot")
abline(0, 1)
#Read in some of the the data for testing
World_one_one = read.csv("World 1-1 Data.csv")
sum(World_one_one[-1,]) #Data checks out
# Create a time index since we don't have other predictors
World_one_one$time = 1:nrow(World_one_one)
# Fit a Poisson GLM with time as predictor
pois_glm = glm(value ~ time, data = World_one_one, family = poisson)
# View summary
summary(pois_glm)
# Test against null model (intercept only)
null_model = glm(value ~ 1, data = World_one_one, family = poisson)
chi_stat = deviance(null_model) - deviance(pois_glm)
df_diff = df.residual(null_model) - df.residual(pois_glm)
p_value = 1 - pchisq(chi_stat, df_diff)
# Goodness of fit test
gof_p_value = 1 - pchisq(deviance(pois_glm), df.residual(pois_glm))
# Check for overdispersion
dispersion_deviance = deviance(pois_glm) / df.residual(pois_glm)
dispersion_pearson = sum(residuals(pois_glm, type = "pearson")^2) / df.residual(pois_glm)
# Plot fitted vs observed
plot(log(fitted(pois_glm)), log((World_one_one$value - fitted(pois_glm))^2),
xlab = expression(hat(lambda)),
ylab = expression((y - hat(lambda))^2),
main = "Variance vs Mean Plot")
abline(0, 1)
gof_p_value
anova(null_model, pois_glm)
anova(pos_glm, null_model)
anova(pois_glm, null_model)
dispersion_deviance = deviance(pois_glm) / df.residual(pois_glm)
dispersion_pearson = sum(residuals(pois_glm, type = "pearson")^2) / df.residual(pois_glm)
cat("Dispersion parameter estimates:\n")
cat("Based on deviance:", dispersion_deviance, "\n")
cat("Based on Pearson residuals:", dispersion_pearson, "\n\n")
# Plot fitted vs observed
plot(log(fitted(pois_glm)), log((World_one_one$value - fitted(pois_glm))^2),
xlab = expression(hat(lambda)),
ylab = expression((y - hat(lambda))^2),
main = "Variance vs Mean Plot")
abline(0, 1)
library(tidyverse)
# Data import and cleaning
wr <- read.csv("~/Downloads/history.csv")
